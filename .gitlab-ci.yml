image: java:latest

stages:
  - build
  - database
  - test

maven-build:
  image: maven:3-jdk-8
  stage: build
  script:
    - echo "Building Jar File"
    - mvn clean install
  artifacts:
    paths:
      - pdx-gun.jar
    expire_in: 1 day


init-database:
  stage: database
  script:
    - echo "Initializing Postgres Database"
    - java -jar pdx-gun.jar
  artifacts:
    paths:
      - init.sql
    expire_in: 1 day


test:
  stage: test
  script:
    - echo "Testing jar file exist"
    - test -f "init.sql"

